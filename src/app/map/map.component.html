<div id="map" style="height: 100vh; width: 100%;"></div>
<p class="hint">üü¢ –ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –∫–∞—Ä—Ç—É, —â–æ–± –¥–æ–¥–∞—Ç–∏ —Ç–æ—á–∫—É. üü† –ù–∞—Ç–∏—Å–Ω–∏ –Ω–∞ –º–∞—Ä–∫–µ—Ä, —â–æ–± —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏. üî¥ –í–∏–¥–∞–ª–∏—Ç–∏ –º–æ–∂–Ω–∞ –≤ —Ä–µ–¥–∞–∫—Ç–æ—Ä—ñ.</p>

<div *ngIf="selectedPoint && modalPosition" class="modal" [ngStyle]="{ left: modalPosition.left + 'px', top: modalPosition.top + 'px', position: 'absolute' }">
  <h3>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–æ—á–∫—É ‚Ññ{{ selectedPoint.number }}</h3>
  <div class="modal-content">
    <label>–®–∏—Ä–æ—Ç–∞: <input type="number" [(ngModel)]="selectedPoint.lat"></label>
    <label>–î–æ–≤–≥–æ—Ç–∞: <input type="number" [(ngModel)]="selectedPoint.lng"></label>
    <label>–í–∏—Å–æ—Ç–∞: <input type="number" [(ngModel)]="selectedPoint.altitude">
  <span class="info-hint" tabindex="0">
    ‚ÑπÔ∏è
    <span class="hint-text">–í–∏—Å–æ—Ç–∞ –Ω–∞–¥ —Ä—ñ–≤–Ω–µ–º –º–æ—Ä—è –≤ –º–µ—Ç—Ä–∞—Ö</span>
  </span>
</label>
  </div>
 
  <div class="modal-actions">
    <button (click)="savePoint()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
    <button (click)="cancelEdit()">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
    <button (click)="deletePoint(selectedPoint.number - 1)">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
  </div>
</div>

<div *ngIf="showFinalModal" class="final-modal-overlay">
  <div class="final-modal">
    <h2 *ngIf="!isSent">–û—Å—Ç–∞—Ç–æ—á–Ω–∏–π –º–∞—Ä—à—Ä—É—Ç</h2>
    <table *ngIf="!isSent" class="final-table">
      <thead>
        <tr>
          <th>‚Ññ</th>
          <th>–®–∏—Ä–æ—Ç–∞</th>
          <th>–î–æ–≤–≥–æ—Ç–∞</th>
          <th>–í–∏—Å–æ—Ç–∞</th>
        </tr>
      </thead>
      <tbody *ngIf="points$ | async as points">
        <tr *ngFor="let p of points">
          <td>{{ p.number }}</td>
          <td>{{ p.lat }}</td>
          <td>{{ p.lng }}</td>
          <td>{{ p.altitude !== undefined ? p.altitude : 0 }}</td>
        </tr>
      </tbody>
    </table>
    <div class="final-actions">
      <button *ngIf="!isSent" (click)="confirmSend()">üì§ –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏</button>
      <span *ngIf="isSent" class="sent-msg">‚úÖ –ú–∞—Ä—à—Ä—É—Ç –≤—ñ–¥–ø—Ä–∞–≤–ª–µ–Ω–æ!</span>
      <button (click)="closeFinalModal()">–ó–∞–∫—Ä–∏—Ç–∏</button>
    </div>
  </div>
</div>

<div *ngIf="(points$ | async) as points">
  <div *ngIf="points.length > 1" class="footer">
    <button (click)="sendToServer()">üì§ –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏ –º–∞—Ä—à—Ä—É—Ç</button>
  </div>
</div>